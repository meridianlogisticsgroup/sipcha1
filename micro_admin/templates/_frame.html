{% set title = title or 'Sipcha Admin' %}
<!doctype html>
<html lang="en" x-data="{ dark: (localStorage.theme || (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark':'light'))==='dark' }"
      x-init="document.documentElement.classList.toggle('theme-dark', dark);
              $watch('dark', v => { document.documentElement.classList.toggle('theme-dark', v); localStorage.theme = v ? 'dark':'light'; })">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>{{ title }}</title>
  <link href="https://cdn.jsdelivr.net/npm/@tabler/icons-webfont@latest/tabler-icons.min.css" rel="stylesheet"/>
  <link href="{{ url_for('static', filename='ui.css') }}" rel="stylesheet"/>
  <script defer src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js"></script>
  <script src="https://unpkg.com/htmx.org@2.0.3"></script>
  <script>
    document.addEventListener('htmx:beforeSwap', () => { const app=document.getElementById('app'); if(app) app.classList.add('app-fade'); });
    document.addEventListener('htmx:afterSwap', () => { const app=document.getElementById('app'); if(app) requestAnimationFrame(()=>app.classList.remove('app-fade')); });
  </script>
</head>
<body hx-boost="true" hx-target="#app" hx-push-url="true">
  <div class="shell">
    <aside class="sidebar">
      <div class="brand">
        <div class="logo"></div>
        <div class="fw-bold">Refine Project</div>
      </div>
      <nav class="nav">
        <a href="{{ url_for('dashboard') }}" class="{% if request.path == '/' %}active{% endif %}"><i class="ti ti-dashboard"></i> Dashboard</a>
        <a href="{{ url_for('admins_index') }}" class="{% if request.path.startswith('/admins') %}active{% endif %}"><i class="ti ti-list-details"></i> Posts</a>
        <form method="post" action="{{ url_for('logout') }}"><button class="btn" style="width:100%; justify-content:flex-start; margin-top:8px"><i class="ti ti-logout"></i> Logout</button></form>
      </nav>
    </aside>
    <section class="main">
      <div class="topbar">
        <span class="htmx-indicator"><i class="ti ti-loader-2 ti-spin"></i></span>
        <button class="btn" @click="dark=!dark"><i :class="dark ? 'ti ti-moon-stars' : 'ti ti-sun'"></i></button>
        {% if user %}<span class="avatar">{{ user.avatar }}</span>{% endif %}
      </div>
      <div class="container">
        <div class="panel">
          <div class="panel-header">{{ title }}</div>
          <div class="panel-body" id="app">
            {% include content_template %}
          </div>
        </div>
      </div>
    </section>
  </div>
</body>
</html>
