{% extends '_layout.html' %}
{% import '_components.html' as ui %}
{% set target = 'admins-table' %}

{% block content %}
<div class="ui-card p-3 mb-3">
  <div class="d-flex align-items-center gap-2 flex-wrap">
    <div class="flex-grow-1" style="min-width:260px">
      <input class="ui-input" name="q" placeholder="Search adminsâ€¦" value="{{ q or '' }}"
             hx-get="{{ url_for('admins_index') }}" hx-target="#{{ target }}" hx-trigger="keyup changed delay:300ms" />
    </div>
    {{ ui.btn('New Admin', 'user-plus', 'primary', attrs='data-bs-toggle=\"modal\" data-bs-target=\"#create-admin\"') }}
  </div>
</div>

<div id="{{ target }}">{% include 'admins/_table.html' %}</div>

<div class="modal" id="create-admin" tabindex="-1">
  <div class="modal-dialog">
    <div class="modal-content ui-card">
      <div class="modal-header">
        <h5 class="modal-title">Create Admin</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <form hx-post="{{ url_for('admins_create') }}" hx-target="#{{ target }}" hx-swap="outerHTML"
            _="on htmx:afterOnLoad call showToast('Created') then trigger click on .btn-close in me">
        <div class="modal-body">{% include 'admins/_form.html' %}</div>
        <div class="modal-footer">
          {{ ui.btn('Save', 'device-floppy', 'primary') }}
        </div>
      </form>
    </div>
  </div>
</div>
{% endblock %}
